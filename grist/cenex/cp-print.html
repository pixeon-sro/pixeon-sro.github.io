<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Tlač cenovej ponuky</title>
    <link href="./style.css" rel="stylesheet" />
    <link href="./stylePrinter.css" rel="stylesheet" media="print" />
    <script src="https://docs.getgrist.com/grist-plugin-api.js"></script>
    <script src="cp.js"></script>
  </head>
  <body>
    <pre id="myDisplay" style="background:red"></pre>
    <h1>Cenová ponuka</h1>
    <hr/>
    <h2><strong>Dielo: </strong><span id="dielo"></span></h2>
    <h2><strong>Investor: </strong><span id="zakaznik"></span></h2>
    <h3>Kontaktné údaje</h3>
    <div>
      <strong>telefón: </strong><span id="telefon"></span><br/>
      <strong>e-mail: </strong><span id="mail"></span>
    </div>
    <hr/>
    <div>
      <strong>Dátum vyhotovenia CP: </strong><span id="datum-vyhotovenia"></span><br/>
      <strong>Dátum platnosti CP: </strong><span id="datum-platnosti"></span>
    </div>
    
    <!-- vynutene zalomenie strany pri tlaci  -->
    <div style="break-after:page"></div>
    
    <pre id="dev">Waiting for data...</pre>
    
    <pre id="readout">Waiting for data...</pre>
    <script>
      // pomocna funkcia na zobrazenie premennych
      let myDisplay = function(zobraz) {
        document.getElementById("myDisplay").innerText = zobraz;
      }
      /*
      // grist pozaduje pristu na čítanie tabulky
      grist.ready({ requiredAccess: 'read table' });
      // nazov stavby
      grist.onRecord(function(record) {
        document.getElementById("dielo").innerText=record.Dielo;
      });
      // meno zakaznika
      grist.onRecord(function(record) {
        document.getElementById("zakaznik").innerText=record.Zakaznik;
      });
      // telefon na zakaznika
      grist.onRecord(function(record) {
        document.getElementById("telefon").innerText=record.Telefon;
      });
      // mail na zakaznika
      grist.onRecord(function(record) {
        document.getElementById("mail").innerText=record.Mail;
      });
      // datum vyhotovenia CP
      grist.onRecord(function(record) {
        document.getElementById("datum-vyhotovenia").innerText=record.Datum_vytvorenia_ponuky;
      });
      // datum platnosti CP
      grist.onRecord(function(record) {
        document.getElementById("datum-platnosti").innerText=record.Datum_platnosti_ponuky;
      });
      // vytvorenie sád pre material, pracu, pridruzene naklady, celkovu cenu
      grist.onRecord(function(record) {
        //prevedenie json na jsObject
        //let cenexObj = JSON.parse(record;
        //set KonecnaCena = record.References.Konecna_cena;
        //document.getElementById('dev').innerText=cenexOBJ;
        console.log(record);
      });
      
      // NUTNE ZAKOMENTOVAT - JSON DATA VIEW
      grist.onRecord(function(record) {
        document.getElementById('readout').innerText=JSON.stringify(record, null, 2);
      });
      */
    </script>
    <a href="javascript:window.print()">Print</a>
  </body>
</html>
